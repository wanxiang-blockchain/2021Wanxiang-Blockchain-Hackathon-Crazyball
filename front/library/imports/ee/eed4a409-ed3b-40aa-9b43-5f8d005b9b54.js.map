{"version":3,"sources":["assets/src/common/event/EventDispatch.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yDAAoD;AAEpD;IAAmC,iCAAc;IAAjD;QAAA,qEAkDC;QAjDW,eAAS,GAAQ,EAAE,CAAC,CAAU,oBAAoB;;IAiD9D,CAAC;IA/CU,iBAAG,GAAV;QACI,OAAO,OAAM,GAAG,WAAmB,CAAC;IACxC,CAAC;IAED,4BAAI,GAAJ,UAAK,KAAiB;QAAE,gBAAgB;aAAhB,UAAgB,EAAhB,qBAAgB,EAAhB,IAAgB;YAAhB,+BAAgB;;QACpC,IAAI,GAAG,GAAU,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,CAAC,GAAG,EAAE;YACN,OAAO;SACV;QACD,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,GAAG,GAAW,GAAG,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,EAAE;YAC/D,IAAI,EAAE,GAAQ,GAAG,CAAC,CAAC,CAAC,CAAC;YACrB,IAAI,IAAI,GAAQ,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAC3B,IAAI,EAAE;gBACF,EAAE,CAAC,IAAI,OAAP,EAAE,kBAAM,IAAI,GAAK,MAAM,GAAE;SAChC;IACL,CAAC;IAED,2BAAG,GAAH,UAAI,KAAiB,EAAE,EAAY,EAAE,IAAgB,EAAE,OAAe;QAAjC,qBAAA,EAAA,WAAgB;QAAE,wBAAA,EAAA,eAAe;QAAE,gBAAgB;aAAhB,UAAgB,EAAhB,qBAAgB,EAAhB,IAAgB;YAAhB,+BAAgB;;QACpF,IAAI,GAAG,GAAU,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,CAAC,GAAG,EAAE;YACN,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;SACpC;QACD,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;QACnB,IAAI,OAAO,EAAE;YACT,EAAE,CAAC,IAAI,OAAP,EAAE,kBAAM,IAAI,GAAK,MAAM,GAAE;SAC5B;IACL,CAAC;IAED,8BAAM,GAAN,UAAO,KAAiB,EAAE,EAAY;QAClC,IAAI,GAAG,GAAU,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,CAAC,GAAG,EAAE;YACN,OAAO;SACV;QACD,IAAI,KAAK,GAAW,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACpC,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,EAAE,CAAC,IAAI,CAAC,0BAAwB,KAAK,yBAAsB,CAAC,CAAC;YAC7D,OAAO;SACV;QACD,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IACzB,CAAC;IAED,6BAAK,GAAL;QACI,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,SAAS,EAAE;YAC5B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC;SAClC;QACD,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;IACxB,CAAC;IACL,oBAAC;AAAD,CAlDA,AAkDC,CAlDkC,wBAAc,GAkDhD;AAlDY,sCAAa;AAoD1B,WAAW;AACX,IAAY,UAYX;AAZD,WAAY,UAAU;IAClB,qEAAiB,CAAA;IACjB,mEAAgB,CAAA;IAChB,uEAAkB,CAAA;IAClB,iFAAuB,CAAA;IACvB,iFAAuB,CAAA;IACvB,uEAAkB,CAAA;IAClB,iFAAuB,CAAA;IACvB,yDAAW,CAAA;IACX,6FAA6B,CAAA;IAC7B,qDAAS,CAAA;IACT,4EAAoB,CAAA;AACxB,CAAC,EAZW,UAAU,GAAV,kBAAU,KAAV,kBAAU,QAYrB","file":"","sourceRoot":"/","sourcesContent":["import SingletonClass from \"../base/SingletonClass\";\n\nexport class EventDispatch extends SingletonClass {\n    private listeners: any = {};          //Event_Name => cb[]\n\n    static ins(): EventDispatch {\n        return super.ins() as EventDispatch;\n    }\n\n    fire(event: Event_Name, ...params: any[]): void {\n        let cbs: any[] = this.listeners[event];\n        if (!cbs) {\n            return;\n        }\n        for (let i: number = 0, len: number = cbs.length; i < len; i += 2) {\n            let cb: any = cbs[i];\n            let host: any = cbs[i + 1];\n            if (cb)\n                cb.call(host, ...params);\n        }\n    }\n\n    add(event: Event_Name, cb: Function, host: any = null, callNow = false, ...params: any[]): void {\n        let cbs: any[] = this.listeners[event];\n        if (!cbs) {\n            this.listeners[event] = cbs = [];\n        }\n        cbs.push(cb, host);\n        if (callNow) {\n            cb.call(host, ...params);\n        }\n    }\n\n    remove(event: Event_Name, cb: Function) {\n        let cbs: any[] = this.listeners[event];\n        if (!cbs) {\n            return;\n        }\n        let index: number = cbs.indexOf(cb);\n        if (index < 0) {\n            cc.warn(`EventDispatch remove ${event}, but cb not exists!`);\n            return;\n        }\n        cbs.splice(index, 2);\n    }\n\n    clear() {\n        for (let key in this.listeners) {\n            this.listeners[key].length = 0;\n        }\n        this.listeners = {};\n    }\n}\n\n/**事件名称定义*/\nexport enum Event_Name {\n    GAME_TIME_CHANGED,\n    GAME_CREATE_BALL,\n    GAME_SCORE_CHANGED,\n    GAME_BALL_POWER_CHANGED,\n    GAME_BEST_SCORE_CHANGED,\n    GAME_ON_TOUCH_MOVE,\n    GAME_POWER_TYPE_CHANGED,\n    GAME_RELIVE,\n    GAME_PLAY_BRICK_REMOVE_EFFECT,\n    SHOW_TIPS,\n    GAME_STAR_GET_EFFECT,\n}"]}