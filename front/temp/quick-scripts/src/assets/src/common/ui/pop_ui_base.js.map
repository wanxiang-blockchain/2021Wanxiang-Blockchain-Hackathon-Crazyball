{"version":3,"sources":["assets/src/common/ui/pop_ui_base.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { pop_mgr, UI_CONFIG } from \"./pop_mgr\"\nimport { pool_mgr } from \"../pool/pool_mgr\"\nimport { handler, gen_handler } from \"../util\"\nimport * as Audio from \"../../common/audio/AudioPlayer\"\n// import { wxHttpClient } from \"../../common/wxapi/index\"\n\nconst { ccclass, property } = cc._decorator;\nconst pop_overlay_bg: string = \"panel_overlay_bg\";\n\n@ccclass\nexport class POP_UI_BASE extends cc.Component {\n\n    @property(cc.Button)\n    btn_close: cc.Button = null;\n\n    //界面名字，UI_CONFIG.*\n    private _ui_name: string;\n    protected is_show: boolean;\n\n    /*由于pop_mgr缓存策略，此方法只会在首次打开界面时调用1次, 缓存以后再打开不会执行onLoad.\n        因此不能用来做每次打开界面时的初始化工作\n    */\n    // onLoad()\n    // {\n    //     cc.log(\"on_load 00000000000000000\");\n    // }\n\n    set ui_name(value: string) {\n        this._ui_name = value;\n    }\n\n    /**\n     * 只能由pop_mgr调用\n     */\n    __show__(...params: any[]): void {\n        // cc.log(\"show\", this._ui_name, ...params);\n        if (this.btn_close) {\n            this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onCloseBtnTouch, this);\n        }\n        this.is_show = true;\n        this.on_show(...params);\n\n        //添加遮罩背景\n        let overlay: cc.Node = this.node.getChildByName(pop_overlay_bg);\n        if (!overlay) {\n            pool_mgr.get_inst().get_ui(UI_CONFIG.overlay_bg, gen_handler((bg_node: cc.Node): void => {\n                if (!this.is_show || this.node.getChildByName(pop_overlay_bg)) {\n                    pool_mgr.get_inst().put_ui(UI_CONFIG.overlay_bg, bg_node);\n                    return;\n                }\n                bg_node.name = pop_overlay_bg;\n                this.node.addChild(bg_node);\n                bg_node.setSiblingIndex(0);\n            }, this));\n        }\n    }\n\n    /**\n     * 只能由pop_mgr调用\n     */\n    __hide__(): void {\n        cc.log(\"hide\", this._ui_name);\n        if (this.btn_close) {\n            this.btn_close.node.off(cc.Node.EventType.TOUCH_END, this.onCloseBtnTouch, this);\n        }\n        this.is_show = false;\n        this.on_hide();\n        // wxHttpClient.unregisterCtxHandler(this);\n    }\n\n    /**弹出界面时调用，且在onLoad之后调用，可以用来做一些初始化工作*/\n    on_show(...params: any[]): void {\n\n    }\n\n    /**关闭界面时调用，用来做清理工作*/\n    on_hide(): void {\n\n    }\n\n    /**关闭自身*/\n    hide(): void {\n        pop_mgr.get_inst().hide(this._ui_name);\n    }\n\n    onCloseBtnTouch(): void {\n        this.hide();\n        Audio.AudioPlayer.ins().play_sound(Audio.AUDIO_CONFIG.Audio_Btn);\n    }\n}"]}