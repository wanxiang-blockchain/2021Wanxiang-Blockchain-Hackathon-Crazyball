{"version":3,"sources":["assets/src/game/GameView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BallItem, { EnumBallStatus } from './item/BallItem';\nimport GameConst from './GameConst';\nimport GameModel from './model/GameModel';\nimport BrickItem from './item/BrickItem';\nimport { RandomUtil } from '../common/random/RandomUtil';\nimport { EventDispatch, Event_Name } from '../common/event/EventDispatch';\nimport { AudioPlayer } from '../common/audio/AudioPlayer';\nimport { gen_handler } from '../common/util';\nimport { loader_mgr } from '../common/loader/loader_mgr';\nimport { Tween, Ease } from '../common/tween/Tween';\nimport { TimerMgr } from '../common/timer/timer_mgr';\nimport { formatPrice } from './common/Common';\nimport State from './model/State';\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class GameView extends cc.Component {\n  @property(cc.Node)\n  bg: cc.Node = null;\n  @property(cc.Node)\n  bgTitle: cc.Node = null;\n  @property(cc.Node)\n  node_top: cc.Node = null;\n  @property(cc.Node)\n  stopButton: cc.Node = null;\n  @property(cc.Node)\n  startButton: cc.Node = null;\n  @property(cc.Node)\n  node_physics: cc.Node = null;\n  @property(cc.Label)\n  lb_ball_count: cc.Label = null;\n  @property(cc.Label)\n  lb_ball_power: cc.Label = null;\n  @property(cc.Node)\n  node_freeze: cc.Node = null;\n  @property(cc.Node)\n  bottomBarBox: cc.Node = null;\n  @property(cc.Prefab)\n  fucPrefab: cc.Prefab = null;\n  @property(cc.Prefab)\n  basePrefab: cc.Prefab = null;\n\n  @property(cc.Label)\n  lb_score: cc.Label = null;\n  @property(cc.Node)\n  node_power_progress: cc.Node = null;\n\n  @property([cc.Prefab])\n  balls_ins: cc.Prefab[] = [];\n  @property([cc.Prefab])\n  bricks_ins: cc.Prefab[] = [];\n\n  @property(cc.Node)\n  node_star_img: cc.Node = null;\n\n  @property(cc.Prefab)\n  star_ins: cc.Prefab = null;\n\n  @property(cc.Node)\n  overLine: cc.Node = null;\n\n  @property(cc.Node)\n  overObj: cc.Node = null;\n  @property(cc.Node)\n  clearLine: cc.Node = null;\n  @property(cc.Node)\n  clearAll: cc.Node = null;\n\n  cannon_head: cc.Node = null;\n  multipleBallCount = 0;\n\n  private brick_max_count = 7;\n\n  private _star_pool: cc.Node[] = [];\n\n  private balls_pool: cc.Node[][] = [];\n  private bricks_pool: cc.Node[][] = [];\n\n  private balls_in_game: BallItem[] = [];\n  private bricks_in_game: BrickItem[] = [];\n\n  private _updateDt: number = 0;\n  private _brick_speed: number = 1;\n  private _moved_length = 0;\n  private _moved_level = 0;\n  // 1 big\n  // 2 speed\n  // 3 freeze\n  private _power_type = 0;\n  _isGameOver = false;\n\n  selfFucActiveSet = new Set();\n\n  onEnable() {\n    State.ins().mainNear.contract.play_game({\n      account_id: State.ins().mainNear.ownerKey\n    });\n    State.ins().isPay = false;\n  }\n\n  onLoad() {\n    this.stopButton.on('touchstart', () => this.onGameStatusToogle(false), this);\n    this.startButton.on('touchstart', () => this.onGameStatusToogle(true), this);\n\n    this.initFuc();\n\n    let random = Math.round(1000000 + Math.random() * 8999999).toString();\n    RandomUtil.ins().init(random);\n\n    this.bg.on('touchmove', this.onTouchMove, this);\n    cc.director.getPhysicsManager().enabled = true;\n    cc.director.getPhysicsManager().enabledAccumulator = true;\n\n    for (let i = 0, len = this.balls_ins.length; i < len; ) {\n      this.balls_pool[i++] = [];\n    }\n\n    for (let i = 0, len = this.bricks_ins.length; i < len; ) {\n      this.bricks_pool[i++] = [];\n    }\n\n    this.gameStart();\n  }\n\n  private initFuc() {\n    if (this.bottomBarBox.children.length > 0) {\n      this.bottomBarBox.removeAllChildren();\n    }\n    new Array(5).fill(1).forEach((item, index) => {\n      let target: cc.Node = null;\n      if (index === 2) {\n        target = cc.instantiate(this.basePrefab);\n        this.cannon_head = target.getChildByName('baseBox');\n      } else {\n        target = cc.instantiate(this.fucPrefab);\n        let fucIndex = index > 1 ? index - 1 : index;\n        State.ins().imageList.map((item, index) => {\n          if (item.sort === fucIndex && item.payCount > 0) {\n            let targetSprite = target.getComponent(cc.Sprite);\n            cc.resources.load(item.url, cc.SpriteFrame, (err, spriteFrame: cc.SpriteFrame) => {\n              targetSprite.spriteFrame = spriteFrame;\n            });\n            let countBox = target.getChildByName('countBox');\n            countBox.active = true;\n            let title = countBox.getChildByName('title').getComponent(cc.Label);\n            title.string = item.title;\n            let countNode = target.getChildByName('count');\n            countNode.active = true;\n            let countLabel = countNode.getComponent(cc.Label);\n            countLabel.string = 'x' + item.payCount;\n            target.on('touchstart', () => this.onFucTouchstart(target, item, index), this);\n          }\n        });\n      }\n      this.bottomBarBox.addChild(target);\n    });\n  }\n\n  private async onFucTouchstart(target: cc.Node, item, itemIndex) {\n    if (this._isGameOver || this.startButton.active) return;\n    if (State.ins().imageList[itemIndex].payCount <= 0) return;\n    if (this.selfFucActiveSet.has(item.type)) return;\n    if (item.type === 2 || item.type === 3 || item.type === 4) {\n      if (this.selfFucActiveSet.has(2) || this.selfFucActiveSet.has(3) || this.selfFucActiveSet.has(4)) return;\n    }\n    this.selfFucActiveSet.add(item.type);\n\n    if (item.payList.length > 0) {\n      let tokenId = State.ins().imageList[itemIndex].payList.splice(0, 1)[0].token_id;\n      State.ins().mainNear.contract.nft_burn({\n        token_id: tokenId\n      });\n    }\n\n    this.bgTitle.active = true;\n    let bgTitleLabel = this.bgTitle.getComponent(cc.Label);\n    let multiple = 1;\n    switch (item.type) {\n      case 6:\n        {\n          bgTitleLabel.string = '';\n          this._isGameOver = true;\n          cc.director.getPhysicsManager().enabled = false;\n          this.bricks_in_game.forEach((item) => {\n            if (Math.abs(item.node.y - this.bricks_in_game[0].node.y) < 45) {\n              item.node.active = false;\n              GameModel.ins().score += Number(item.lb_hp.string);\n              if (item.star_num > 0) {\n                GameModel.ins().ball_power += item.star_num;\n                AudioPlayer.ins().play_sound('star');\n              }\n              if (item.ball_num > 0) {\n                for (let index = 0; index < item.ball_num; index++) {\n                  EventDispatch.ins().fire(Event_Name.GAME_CREATE_BALL);\n                }\n                AudioPlayer.ins().play_sound('balls');\n              }\n            }\n          });\n          this.clearLine.active = true;\n          this.clearLine.setPosition(750, this.bricks_in_game[0].node.y);\n          cc.tween(this.clearLine)\n            .to(0.3, { x: -750 })\n            .call(() => {\n              this._isGameOver = false;\n              cc.director.getPhysicsManager().enabled = true;\n              this.clearLine.active = false;\n            })\n            .start();\n        }\n        break;\n      case 1:\n        this.node_freeze.active = true;\n        bgTitleLabel.string = '冻结全屏';\n        break;\n      case 2:\n        this.cannon_head.scale = 1.4;\n        bgTitleLabel.string = '两倍加速';\n        multiple = 2;\n        break;\n      case 3:\n        this.cannon_head.scale = 1.7;\n        bgTitleLabel.string = '三倍加速';\n        multiple = 3;\n        break;\n      case 4:\n        this.cannon_head.scale = 2;\n        bgTitleLabel.string = '五倍加速';\n        multiple = 5;\n        break;\n      case 5:\n        {\n          bgTitleLabel.string = '';\n          this._isGameOver = true;\n          cc.director.getPhysicsManager().enabled = false;\n          this.bricks_in_game.forEach((item) => {\n            item.node.active = false;\n            let hp = 0;\n            if (item.lb_hp.string.indexOf('M') !== -1) {\n              hp = Number(item.lb_hp.string.split('M')[0]) * 1000000;\n            }\n            if (item.lb_hp.string.indexOf('K') !== -1) {\n              hp = Number(item.lb_hp.string.split('K')[0]) * 1000;\n            }\n            GameModel.ins().score += hp;\n            if (item.star_num > 0) {\n              GameModel.ins().ball_power += item.star_num;\n              AudioPlayer.ins().play_sound('star');\n            }\n            if (item.ball_num > 0) {\n              for (let index = 0; index < item.ball_num; index++) {\n                EventDispatch.ins().fire(Event_Name.GAME_CREATE_BALL);\n              }\n              AudioPlayer.ins().play_sound('balls');\n            }\n          });\n          this.clearAll.active = true;\n          cc.tween(this.clearAll.getChildByName('bg3'))\n            .to(0.3, { angle: 180 })\n            .to(0.3, { angle: 360 })\n            .repeat(2)\n            .call(() => {\n              this.clearAll.active = false;\n              this.clearAll.getChildByName('bg3').angle = -0;\n              this._isGameOver = false;\n              cc.director.getPhysicsManager().enabled = true;\n            })\n            .start();\n        }\n        break;\n    }\n\n    this.multipleBallCount = GameModel.ins().ball_power * (multiple - 1);\n    GameModel.ins().ball_power += this.multipleBallCount;\n\n    State.ins().imageList[itemIndex].payCount -= 1;\n    let count = target.getChildByName('count').getComponent(cc.Label);\n    count.string = 'x' + State.ins().imageList[itemIndex].payCount.toString();\n    AudioPlayer.ins().play_sound('levelup');\n\n    let timeBox = target.getChildByName('timeBox');\n    timeBox.active = true;\n    let timeBoxSprite = timeBox.getComponent(cc.Sprite);\n    cc.tween(timeBoxSprite)\n      .to(item.time, {\n        fillRange: 0\n      })\n      .start();\n\n    let time = item.time;\n    let callback = () => {\n      time--;\n      this.bgTitle.active = false;\n      if (time <= 0) {\n        this.unschedule(callback);\n        timeBoxSprite.fillRange = 1;\n        timeBox.active = false;\n        if (item.type === 1) {\n          this.node_freeze.active = false;\n        }\n        if (item.type === 2 || item.type === 3 || item.type === 4) {\n          this.cannon_head.scale = 1;\n          GameModel.ins().ball_power -= this.multipleBallCount;\n          this.multipleBallCount = 0;\n        }\n        this.selfFucActiveSet.delete(item.type);\n      }\n    };\n    this.schedule(callback, 1);\n  }\n\n  private onGameStatusToogle(status) {\n    if (!this.overObj.active) {\n      AudioPlayer.ins().play_sound('btn');\n      if (status) {\n        this.stopButton.active = true;\n        this.startButton.active = false;\n        this._isGameOver = false;\n        cc.director.getPhysicsManager().enabled = true;\n        AudioPlayer.ins().play_music('bg');\n      } else {\n        this.stopButton.active = false;\n        this.startButton.active = true;\n        this._isGameOver = true;\n        cc.director.getPhysicsManager().enabled = false;\n        AudioPlayer.ins().stop_music();\n      }\n    }\n  }\n\n  private onTouchMove(param: cc.Event.EventTouch) {\n    const deltaX = param.getDeltaX();\n    const deltaY = param.getDeltaY();\n    const deltaR = Math.sqrt(deltaX * deltaX + deltaY * deltaY) * 0.3;\n    const sign = Math.sign(deltaX);\n    let angle = -this.cannon_head.angle + deltaR * sign;\n    angle = Math.abs(angle) >= 85 ? Math.sign(angle) * 85 : angle;\n    this.cannon_head.angle = -angle;\n  }\n\n  private gameStart() {\n    EventDispatch.ins().add(Event_Name.GAME_CREATE_BALL, this.createBall, this);\n    EventDispatch.ins().add(Event_Name.GAME_RELIVE, this.gameRelive, this);\n    EventDispatch.ins().add(Event_Name.GAME_ON_TOUCH_MOVE, this.onTouchMove, this);\n    EventDispatch.ins().add(Event_Name.GAME_POWER_TYPE_CHANGED, this.updateGamePowerType, this);\n    EventDispatch.ins().add(Event_Name.GAME_SCORE_CHANGED, this.updateScore, this, true);\n    EventDispatch.ins().add(Event_Name.GAME_BALL_POWER_CHANGED, this.updateBallPower, this, true);\n    EventDispatch.ins().add(Event_Name.GAME_PLAY_BRICK_REMOVE_EFFECT, this.playBrickDeleteEffect, this);\n    EventDispatch.ins().add(Event_Name.GAME_STAR_GET_EFFECT, this.updateStarNumGetEffect, this);\n    AudioPlayer.ins().play_music('bg');\n\n    this.resetGame();\n  }\n\n  private resetGame() {\n    this.node_physics.active = true;\n    this.cannon_head.angle = 0;\n    cc.director.getPhysicsManager().enabled = true;\n    this._updateDt = 0;\n    this._moved_length = 0;\n    this._moved_level = 0;\n    this._isGameOver = false;\n    this.updateGamePowerType(0);\n    GameModel.ins().reset();\n    const ball_init_count = GameModel.ins().ball_init_count;\n    for (let index = 0; index < ball_init_count; index++) {\n      this.createBall();\n    }\n    const brick_radius = GameConst.ins().brick_radius;\n    for (let i = 0; i < 2; i++) {\n      let rightNumber = Math.round(this.brick_max_count / 2);\n      let leftNumber = -1 * Math.floor(this.brick_max_count / 2);\n      for (let j = leftNumber; j < rightNumber; j++) {\n        let hp = (i + 1) * GameModel.ins().ball_power + (ball_init_count - 4);\n        hp = hp < 0 ? 1 : hp;\n        this.createBrick(j * brick_radius * 2 + GameConst.ins().brick_init_x, i * brick_radius * 2 + GameConst.ins().brick_init_y, hp);\n      }\n    }\n\n    this.lb_ball_power.string = `${GameModel.ins().ball_power}`;\n  }\n\n  update(dt) {\n    TimerMgr.getInst().update(dt);\n\n    if (this._isGameOver) return;\n\n    if (this.node_freeze.active) {\n      this._brick_speed = 0;\n    }\n\n    if (this._power_type > 0) {\n      this.node_power_progress.width -= 1.5;\n      if (this.node_power_progress.active && this.node_power_progress.width <= 0) {\n        this.updateGamePowerType(0);\n      }\n      switch (this._power_type) {\n        case 3: {\n          this._brick_speed = 0;\n          break;\n        }\n      }\n    }\n\n    this._updateDt++;\n    this._moved_length += this._brick_speed;\n\n    if (this._updateDt % GameModel.ins().fireBallDt === 0 || this._power_type === 2) {\n      this.balls_in_game.some((item) => {\n        if (item.ball_status === EnumBallStatus.onReady && (item.ball_type === 0 || this._power_type === 2)) {\n          item.power_scale = this._power_type === 1 ? 2 : 1;\n          item.fireBall(-this.cannon_head.angle);\n          return true;\n        }\n        return false;\n      });\n    }\n\n    const brick_radius = GameConst.ins().brick_radius;\n    const ball_power = GameModel.ins().ball_power - this.multipleBallCount;\n    const new_level = Math.floor(this._moved_length / 4 / brick_radius);\n    if (new_level > this._moved_level) {\n      this._moved_level++;\n      let balls_in_game_length = this.balls_in_game.length / (this._power_type === 2 ? 2 : 1);\n      const maxHp = Math.ceil(balls_in_game_length * ball_power * 0.5 + this._moved_level * ball_power * 1.2);\n      const brick_type_percent = GameConst.ins().brick_type_percent;\n      let big_j = -999;\n      let item_i = -999,\n        item_j = -999;\n      if (this._moved_level % 12 === 0) {\n        big_j = RandomUtil.ins().randomNum(-2, 3);\n        this.createBrick(\n          -brick_radius + big_j * brick_radius * 2 + GameConst.ins().brick_init_x,\n          brick_radius + GameConst.ins().brick_init_y,\n          RandomUtil.ins().randomNum(maxHp * 3, maxHp * 6),\n          RandomUtil.ins().randomNum(14, 16),\n          10\n        );\n      }\n      if (this._moved_level % 11 === 0) {\n        item_i = RandomUtil.ins().randomNum(0, 1);\n        item_j = RandomUtil.ins().randomNum(-3, 3);\n      }\n      for (let i = 0; i < 2; i++) {\n        for (let j = -3; j < 4; j++) {\n          if (j === big_j || j === big_j - 1) {\n          } else {\n            let hp =\n              i === item_i && j === item_j\n                ? RandomUtil.ins().randomNum(ball_power, Math.ceil(maxHp / 2))\n                : RandomUtil.ins().randomNum(-Math.round(maxHp / ((this._moved_level % 5) + 1)), maxHp);\n            let brick_type =\n              i === item_i && j === item_j\n                ? RandomUtil.ins().randomNum(11, 13)\n                : brick_type_percent[RandomUtil.ins().randomNum(0, brick_type_percent.length - 1)];\n            if (hp >= ball_power) {\n              this.createBrick(\n                j * brick_radius * 2 + GameConst.ins().brick_init_x,\n                i * brick_radius * 2 + GameConst.ins().brick_init_y,\n                hp,\n                brick_type,\n                Math.ceil((hp * 10) / maxHp)\n              );\n            }\n          }\n        }\n      }\n    }\n\n    let brick_min_y = 9999;\n    for (let index = 0, len = this.bricks_in_game.length; index < len; index++) {\n      const element = this.bricks_in_game[index];\n      if (element && element.node) {\n        const brick = element.node;\n        if (element.hp <= 0 || !brick.active) {\n          if (this._updateDt % 60 === 0) {\n            element.reset();\n            this.bricks_in_game.splice(index, 1);\n            this.bricks_pool[element.brick_type].push(brick);\n            index--;\n          }\n        } else {\n          brick.y -= this._brick_speed;\n          if (brick.y - element.brick_radius_mul * brick_radius <= this.overLine.y) {\n            this.gameOver();\n            return;\n          }\n          if (brick.y < brick_min_y) {\n            brick_min_y = brick.y;\n          }\n        }\n      }\n    }\n    this._brick_speed =\n      brick_min_y > GameConst.ins().ball_init_y + brick_radius * 7 ? 1 : brick_min_y > GameConst.ins().ball_init_y + brick_radius * 5 ? 0.9 : 0.6;\n  }\n\n  private createBall(x = GameConst.ins().ball_init_x, y = GameConst.ins().ball_init_y, status = EnumBallStatus.onReady, ball_type = 0) {\n    let ball = this.balls_pool[ball_type].shift();\n    if (!ball) {\n      ball = cc.instantiate(this.balls_ins[ball_type]);\n      this.node_physics.addChild(ball);\n    }\n    const item = ball.getComponent(BallItem);\n    item.init(x, y, status);\n    ball.active = true;\n    this.balls_in_game.unshift(item);\n    this.lb_ball_count.string = `${this.balls_in_game.length / 2}`;\n    if (ball_type === 0) {\n      this.createBall(GameConst.ins().ball_init_x, GameConst.ins().ball_init_y, EnumBallStatus.onReady, 1);\n    }\n  }\n\n  private createBrick(x = GameConst.ins().brick_init_x, y = GameConst.ins().brick_init_y, hp = 1, brick_type = 0, colors_num = 1) {\n    if (brick_type === this.brick_max_count && this.balls_in_game.length > 200) {\n      brick_type = 0;\n    }\n    let brick = this.bricks_pool[brick_type].shift();\n    if (!brick) {\n      brick = cc.instantiate(this.bricks_ins[brick_type]);\n      this.node_physics.addChild(brick);\n    }\n    const item = brick.getComponent(BrickItem);\n    brick.active = true;\n    brick.x = x;\n    brick.y = y;\n    item.init(colors_num, hp);\n    this.bricks_in_game.push(item);\n  }\n\n  private updateScore(old?: number, newValue?: number) {\n    this.lb_score.string = formatPrice(GameModel.ins().score, 0, false, ' ');\n  }\n\n  private updateBallPower(old?: number, newValue?: number) {\n    this.lb_ball_power.string = `${GameModel.ins().ball_power}`;\n  }\n\n  private updateStarNumGetEffect(x: number, y: number, count: number) {\n    const targetPos = this.node_top.convertToNodeSpaceAR(this.node_star_img.convertToWorldSpaceAR(cc.v2(0, 0)));\n    for (let index = 0; index < count; index++) {\n      let star_item = this._star_pool.shift();\n      if (!star_item) {\n        star_item = cc.instantiate(this.star_ins);\n        this.node_top.addChild(star_item);\n      }\n      star_item.x = x;\n      star_item.y = y;\n      star_item.angle = 0;\n      star_item.active = true;\n      Tween.get(star_item)\n        .to({ angle: 720, x: targetPos.x, y: targetPos.y }, 800 + 100 * index, Ease.getBackInOut(1.2))\n        .call(() => {\n          star_item.active = false;\n          this._star_pool.push(star_item);\n          Tween.get(this.node_star_img)\n            .to({ scale: 1.2 }, 300)\n            .to({ scale: 1 }, 300, Ease.backInOut)\n            .call(() => {\n              GameModel.ins().ball_power += 1;\n              this.lb_ball_power.string = `${GameModel.ins().ball_power}`;\n            });\n        });\n    }\n  }\n\n  private _brick_img_pool: cc.Node[] = [];\n  private playBrickDeleteEffect(x: number, y: number, color: cc.Color) {\n    const theme_cfg = GameConst.ins().theme_config[0];\n    if (theme_cfg) {\n      loader_mgr.get_inst().loadAsset(\n        'texture/plist/customize',\n        gen_handler((res: cc.SpriteAtlas) => {\n          const spriteFrame = res.getSpriteFrame(theme_cfg.theme);\n          if (spriteFrame) {\n            for (let index = 0; index < 9; index++) {\n              const i = (index % 3) - 1.5;\n              const j = Math.floor(index / 3) - 1.5;\n              const targetPosX = x + i * (100 + 150 * Math.random());\n              const targetPosY = y + j * (100 + 150 * Math.random());\n              let img = this._brick_img_pool.shift();\n              if (!img) {\n                img = new cc.Node();\n                img.addComponent(cc.Sprite);\n                this.node_physics.addChild(img);\n              }\n              img.active = true;\n              img.angle = 0;\n              img.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n              img.color = color;\n              const size = Math.random() * 50 + 50;\n              img.width = img.height = size;\n              img.x = x;\n              img.y = y;\n              Tween.get(img)\n                .to({ x: targetPosX, y: targetPosY, width: size / 3, height: size / 3, angle: 1000 * Math.random() }, Math.random() * 500 + 500)\n                .call(() => {\n                  img.active = false;\n                  this._brick_img_pool.push(img);\n                });\n            }\n          } else {\n          }\n        }),\n        cc.SpriteAtlas\n      );\n    }\n  }\n\n  private updateGamePowerType(power = 0) {\n    if (power > 0) {\n      if (this._power_type === 0) {\n        this.node_power_progress.active = true;\n        this.node_power_progress.width = 750;\n        this._power_type = power;\n        let bgTitleLabel = this.bgTitle.getComponent(cc.Label);\n        switch (power) {\n          case 2: {\n            this.cannon_head.scale = 1.4;\n            break;\n          }\n          case 3: {\n            this.node_freeze.active = true;\n            break;\n          }\n        }\n        this.lb_ball_count.node.color = this.node_power_progress.color =\n          [cc.Color.WHITE, cc.Color.RED, cc.Color.YELLOW, cc.Color.GRAY][power] || cc.Color.WHITE;\n        AudioPlayer.ins().play_sound('levelup');\n      }\n    } else {\n      this.node_power_progress.active = false;\n      this.node_power_progress.width = 750;\n      this.lb_ball_count.node.color = cc.color(230, 150, 26);\n      if (!this.selfFucActiveSet.has(1)) {\n        this.node_freeze.active = false;\n      }\n      if (!this.selfFucActiveSet.has(2) && !this.selfFucActiveSet.has(3) && !this.selfFucActiveSet.has(4)) {\n        this.cannon_head.scale = 1;\n      }\n      this._power_type = power;\n    }\n  }\n\n  gameRelive() {\n    this.bricks_in_game.forEach((value) => {\n      value.reset();\n      this.bricks_pool[value.brick_type].push(value.node);\n    });\n    this.bricks_in_game = [];\n    this.overObj.active = false;\n    this._isGameOver = false;\n    cc.director.getPhysicsManager().enabled = true;\n    AudioPlayer.ins().play_music('bg');\n  }\n\n  private gameOver() {\n    this._isGameOver = true;\n    cc.director.getPhysicsManager().enabled = false;\n    this.overObj.active = true;\n    EventDispatch.ins().add(Event_Name.GAME_RELIVE, this.gameRelive, this);\n    AudioPlayer.ins().stop_music();\n  }\n}\n"]}