{"version":3,"sources":["assets/src/game/item/BallItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameConst from '../GameConst';\nimport GameModel from '../model/GameModel';\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class BallItem extends cc.Component {\n  // 0 default\n  // 1 big\n  @property(cc.Integer)\n  ball_type: number = 0;\n\n  @property(cc.Sprite)\n  ball_icon: cc.Sprite = null;\n\n  private _ball_status: EnumBallStatus = 0;\n  public get ball_status() {\n    return this._ball_status;\n  }\n  public set ball_status(status) {\n    this._ball_status = status;\n    switch (status) {\n      case EnumBallStatus.onLand: {\n        this.scheduleOnce(() => {\n          if (this.node && this.node.active) {\n            this.node.setPosition(GameConst.ins().ball_init_x, GameConst.ins().ball_init_y);\n            this.ball_status = EnumBallStatus.onReady;\n          }\n        }, 0);\n        break;\n      }\n      case EnumBallStatus.onReady: {\n        break;\n      }\n      case EnumBallStatus.onRemoved: {\n        break;\n      }\n    }\n  }\n\n  private _power_scale: number = 1;\n  public get power_scale() {\n    return this._power_scale;\n  }\n  public set power_scale(value) {\n    this._power_scale = value;\n    this.ball_icon.node.setScale(value > 1 ? 1.5 : 1);\n  }\n\n  reset() {\n    this.node.stopAllActions();\n    this._ball_status = EnumBallStatus.onRemoved;\n    this.getComponent(cc.RigidBody).linearVelocity = cc.v2(0, 0);\n    this.power_scale = 1;\n    this.node.active = false;\n  }\n\n  init(x: number, y: number, status: EnumBallStatus) {\n    this.power_scale = 1;\n    this.node.x = x;\n    this.node.y = y;\n    this.ball_status = status;\n\n    this.setImage(this.ball_icon, 'images/e1');\n  }\n\n  setImage(target, url: string) {\n    cc.resources.load(url, cc.SpriteFrame, (err, spriteFrame: cc.SpriteFrame) => {\n      target.spriteFrame = spriteFrame;\n    });\n  }\n\n  fireBall(fire_rotation: number) {\n    const radians = (fire_rotation * Math.PI) / 180;\n    const ball_speed = GameConst.ins().ball_speed + 100 * GameModel.ins().ball_fire_speed;\n    this.getComponent(cc.RigidBody).linearVelocity = cc.v2(Math.sin(radians) * ball_speed, Math.cos(radians) * ball_speed);\n    this.ball_status = EnumBallStatus.onFire;\n  }\n\n  onBeginContact(contact: cc.PhysicsContact, selfCollider: cc.PhysicsCollider, otherCollider: cc.PhysicsCollider) {\n    switch (otherCollider.tag) {\n      case 1: {\n        if (this.node.active) {\n          this.getComponent(cc.RigidBody).linearVelocity = cc.v2(0, 0);\n          this.ball_status = EnumBallStatus.onLand;\n        }\n        break;\n      }\n    }\n  }\n}\n\nexport enum EnumBallStatus {\n  onReady = 0,\n  onLand = 1,\n  onFire = 2,\n  onRemoved = 3\n}\n"]}